# Dependency Visualizer: Инструмент визуализации графа зависимостей

## 1. Общее описание

Инструмент `Dependency Visualizer` предназначен для **анализа и визуализации графа зависимостей** пакетов Python. Проект выполняет пошаговый анализ (от сбора данных до визуализации) без использования готовых менеджеров пакетов или сторонних библиотек для получения метаданных о зависимостях, что соответствует требованиям практической работы.

### Ключевые особенности:

* **Пошаговый анализ:** Работает по этапам (С 1 до 5).
* **Два режима работы:** Поддержка тестового режима (локальный репозиторий с папками A, B, C...) и режима реального репозитория (PyPI).
* **Обработка графа:** Построение графа с помощью **BFS** (Breadth-First Search), ограничение по **максимальной глубине**, **фильтрация** по подстроке и корректное обнаружение и пометка **циклических зависимостей**.
* **Топологическая сортировка:** Расчет **рекомендуемого порядка установки** (загрузки), исключая циклические узлы.
* **Визуализация:** Генерация графа в формате **Graphviz DOT** с последующим рендерингом в изображение (PNG), где циклы подсвечиваются красным цветом.

***

## 2. Описание функций и настроек

### 2.1. Настройки (Конфигурационный файл `config.yaml`)

Все параметры работы инструмента задаются в файле `config.yaml`.

| Настройка | Тип | Описание |
| :--- | :--- | :--- |
| `package_name` | String | **Имя анализируемого корневого пакета** (напр., `'A'`). |
| `repository_url` | String | URL-адрес реального репозитория (напр., `'https://pypi.org/simple/'`). **Используется только в реальном режиме.** |
| `test_repository_path` | String | **Путь к папке тестового репозитория** (напр., `'./test_repo'`). Используется в тестовом режиме. |
| `test_mode` | Boolean | Если `True`, используется `test_repository_path` и локальные файлы `setup.py`. |
| `max_depth` | Integer | **Максимальная глубина** транзитивных зависимостей для анализа (напр., `3`). |
| `filter_substring` | String | Подстрока для **исключения** пакетов из графа (напр., `'Z'`). Регистр не учитывается. |

### 2.2. Основные функции (Этапы)

| Функция | Этап | Назначение |
| :--- | :--- | :--- |
| `run_stage1()` | **ЭТАП 1** | Загрузка и **валидация конфигурации** из `config.yaml`, вывод всех настроек. |
| `run_stage2()` | **ЭТАП 2** | Получение и вывод **прямых зависимостей** для `package_name`. |
| `run_stage3()` | **ЭТАП 3** | Построение полного **графа зависимостей** с помощью BFS. Включает ограничение глубины и фильтрацию. |
| `run_stage4()` | **ЭТАП 4** | Выполнение **топологической сортировки** графа для определения порядка установки. Обрабатывает и исключает циклические зависимости. |
| `run_stage5()` | **ЭТАП 5** | Генерация графа в формате **Graphviz DOT** и рендеринг в изображение (PNG), включая подсветку циклов. |

***

## 3. Описание команд для сборки проекта и запуска

### 3.1. Предварительные требования (Сборка)

Для работы необходимы **Python 3.x** и следующие зависимости:

1.  **Библиотеки Python:**
    ```bash
    pip install pyyaml  # Для парсинга config.yaml
    pip install graphviz # Для генерации изображения из DOT-кода
    pip install pipdeptree # Опционально: для сравнения на Этапе 4
    ```
2.  **Инструмент визуализации Graphviz:**
    * `Graphviz` – это внешний инструмент, который должен быть установлен в системе и добавлен в системный путь (`PATH`).
    * **Установка:** [https://graphviz.org/download/](https://graphviz.org/download/)

### 3.2. Запуск этапов

Запуск производится с указанием конфигурационного файла и номера этапа:

```bash
python dependency_visualizer.py <config_file.yaml> --stage{номер этапа}
```
Пример для пятого этапа:

```bash
python dependency_visualizer.py <config_file.yaml> --stage5
```